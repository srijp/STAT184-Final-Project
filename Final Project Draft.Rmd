---
title: "Final Project Draft"
author: "Radha Patel and Srija Pinnamaneni"
date: "April 12, 2020"
output: html_notebook
---

### Guiding Question (i.e., Research Question):

What sort of relationship does population and coronavirus count have (exponential, linear, etc.)?

### Become acquainted with your data sources
```{r}
library(readr)
library(tidyr)
library(dplyr)
library(DataComputing)
library(lubridate)
covid_confirmed_usafacts <- read_csv("covid_confirmed_usafacts (1).csv")
```
```{r}
nrow(covid_confirmed_usafacts)
names(covid_confirmed_usafacts)
nrow(ZipGeography)
names(ZipGeography)
```
We are using data from https://usafacts.org/visualizations/coronavirus-covid-19-spread-map/

We are using ZipGeogrophy from the DataComputing package to compare total populations per state to the coronavirus count.

```{r}
covid_per_state <-
  covid_confirmed_usafacts %>%
  filter(`countyFIPS` > 100)
drop <- c('countyFIPS','County Name')
newcovid <- covid_per_state[ , !(names(covid_per_state) %in% drop)]

CovidPlot <-
  newcovid %>%
  gather(key = "Date", value = "confirmedcases", "1/22/20":"4/3/20") %>%
  mutate(Date = lubridate::mdy(Date)) %>%
  mutate(State = as.character(State)) %>%
  mutate(stateFIPS = as.numeric(stateFIPS)) %>%
  group_by(State,stateFIPS,Date) %>%
  summarise(confirmedcases = sum(confirmedcases)) %>%
  filter(confirmedcases > 0) %>%
  arrange(stateFIPS,Date)

StateRank <-
  CovidPlot %>%
  group_by(stateFIPS) %>%
  summarise(totalcases = sum(confirmedcases)) %>%
  mutate(rank = rank(stateFIPS))

NewCovidPlot <-
  StateRank %>%
  select(stateFIPS,rank) %>%
  left_join(CovidPlot, by = c("stateFIPS" = "stateFIPS"))

NewCovidPlot
```
This shows the number of cases reported each day in New Jersey starting in March.

```{r}
sumStates <-
  NewCovidPlot %>%
  group_by(State,rank) %>%
  summarise(count = max(confirmedcases))
sumStates
ggplot(data=sumStates,aes(x=State,y=count))+geom_bar(stat='identity',position='stack')
```
This plot shows the total number of cases in the country.

```{r}
popSum <-
  ZipGeography %>%
  mutate(State = as.character(State)) %>%
  group_by(State) %>%
  filter(State != '', Population > 0) %>%
  summarise(statepop = sum(Population)) %>%
  mutate(rank = rank(State))
popSum %>%
  arrange(desc(statepop))
```

```{r}
CovidCasesAndPop <-
  popSum %>%
  left_join(NewCovidPlot %>% select(rank,Date,confirmedcases),
             by = c("rank" = "rank"))
CovidCasesAndPop
CovidTotalAndPop <-
  sumStates %>%
  select(rank,count) %>%
  left_join(popSum %>% select(rank,statepop),
            by = c("rank" = "rank")) %>%
  mutate(covid_pop_percent = count/statepop*100)
CovidTotalAndPop %>%
  arrange(desc(count))
ggplot(CovidTotalAndPop,aes(x=State,y=covid_pop_percent))+geom_bar(stat='identity',position='stack')
ggplot(CovidTotalAndPop,aes(x=count,y=statepop))+geom_point(aes(x=count,y=statepop))
```
```{r}
UScovid <-
  NewCovidPlot %>%
  group_by(Date) %>%
  summarise(casecount = sum(confirmedcases))
UScovid
ggplot(UScovid,aes(x=Date,y=casecount))+geom_point(aes(x=Date,y=casecount))
```
```{r}
NYandNJ <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) > 20000)
ggplot(NYandNJ,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group1 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 20000) %>%
  filter(max(confirmedcases) > 10000)
ggplot(Group1,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group2 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 10000) %>%
  filter(max(confirmedcases) > 5000)
ggplot(Group2,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group3 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 5000) %>%
  filter(max(confirmedcases) > 2500)
ggplot(Group3,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group4 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 2500) %>%
  filter(max(confirmedcases) > 1600)
ggplot(Group4,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group5 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 1600) %>%
  filter(max(confirmedcases) > 1000)
ggplot(Group5,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group6 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 1000) %>%
  filter(max(confirmedcases) > 700)
ggplot(Group6,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group7 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 700) %>%
  filter(max(confirmedcases) >= 450)
ggplot(Group7,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group8 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 450) %>%
  filter(max(confirmedcases) > 200)
ggplot(Group8,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
Group9 <-
  CovidCasesAndPop %>%
  group_by(rank) %>%
  filter(max(confirmedcases) < 200)
ggplot(Group9,aes(x=Date,y=confirmedcases))+geom_point(aes(x=Date,y=confirmedcases))+aes(colour = State)
```

